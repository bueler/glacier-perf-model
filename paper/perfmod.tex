\documentclass[twocolumn,letterpaper]{igs}
%\documentclass[twocolumn]{igs}  % A4 paper needs no option
%\documentclass[review,letterpaper]{igs}

\usepackage{verbatim,xspace,amsmath,amssymb,bm,multirow,dashbox}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usepackage{igsnatbib,lineno}

\usepackage{hyperref}
\hypersetup{pdfauthor={Ed Bueler},
            pdfcreator={pdflatex},
            colorlinks=true,
            citecolor=purple,
            linkcolor=red,
            urlcolor=blue,
            }

% math macros
\newcommand\bb{\mathbf{b}}
\newcommand\bc{\mathbf{c}}
\newcommand\bbf{\mathbf{f}}
\newcommand\bg{\mathbf{g}}
\newcommand\bn{\mathbf{n}}
\newcommand\bq{\mathbf{q}}
\newcommand\bu{\mathbf{u}}
\newcommand\bv{\mathbf{v}}
\newcommand\bx{\mathbf{x}}
\newcommand\by{\mathbf{y}}

\newcommand\bA{\mathbf{A}}
\newcommand\bF{\mathbf{F}}
\newcommand\bH{\mathbf{H}}
\newcommand\bN{\mathbf{N}}
\newcommand\bQ{\mathbf{Q}}
\newcommand\bU{\mathbf{U}}
\newcommand\bV{\mathbf{V}}
\newcommand\bW{\mathbf{W}}
\newcommand\bX{\mathbf{X}}

\newcommand\bzero{\bm{0}}

\newcommand{\Div}{\nabla\cdot}
\newcommand\eps{\epsilon}
\newcommand{\grad}{\nabla}
\newcommand{\ip}[2]{\ensuremath{\left<#1,#2\right>}}
\newcommand\lam{\lambda}
\newcommand\lap{\triangle}
\newcommand\RR{\mathbb{R}}
\newcommand{\half}{\tfrac{1}{2}}

\newcommand{\Divx}{\nabla_\bx \cdot}
\newcommand{\gradx}{\nabla_\bx}

\newcommand{\rhoi}{\rho_{\text{i}}}
\newcommand{\pp}{{\text{p}}}
\newcommand{\qq}{{\text{q}}}
\newcommand{\rr}{{\text{r}}}

\newcommand{\mR}{R^{\bm{\oplus}}}
\newcommand{\iR}{R^{\bullet}}

\newcommand{\sold}{s_{\text{o}}}
\newcommand{\told}{t_{\text{o}}}

\newcommand{\byold}{\by_{\text{o}}}

\newcommand{\onecol}[1]{\includegraphics[width=86mm]{#1}}
\newcommand{\onecolless}[1]{\includegraphics[width=80mm]{#1}}
\newcommand{\onecolthin}[1]{\includegraphics[width=75mm]{#1}}

%\newcommand{\twocol}[1]{\includegraphics[width=178mm]{#1}}
\newcommand{\twocol}[1]{\includegraphics[width=165mm]{#1}}
\newcommand{\twocolless}[1]{\includegraphics[width=140mm]{#1}}

\newcommand{\ds}{\displaystyle}

\begin{document}

\title[Performance analysis of high-resolution ice sheet simulations]{Performance analysis of high-resolution \\ ice sheet simulations}

\abstract{Numerical glacier and ice sheet models compute evolving ice geometry and velocity fields using various stress-balance approximations and boundary conditions.  At high spatial resolution, with horizontal mesh/grid resolutions of a few kilometers or smaller, these models usually require time steps shorter than climate-coupling time scales because they update ice thickness after each velocity solution.  High-resolution performance is degraded by the stability restrictions of such explicit time-stepping.  This short note, which considers the shallow ice approximation and Stokes models as stress-balance end members, clarifies the scaling of numerical model performance by quantifying simulation cost per model year in terms of mesh resolution and the number of degrees of freedom.  The performance of current-generation explicit time-stepping models is assessed, and then compared to the prospective performance of implicit schemes.  The main result, Table \ref{tab:performancemodel}, highlights the key roles played by the algorithmic scaling of stress-balance and coupled, implicit-step solvers.}

\author{Ed Bueler}

\affiliation{Dept.~Mathematics and Statistics, University of Alaska Fairbanks, USA \\
E-mail: \emph{\texttt{elbueler\@@alaska.edu}}}

%\keywords{glacier flow,glacier modelling,ice-sheet modelling}
% suggested reviewers:  Dan Goldberg, William Lipscomb, Toby Isaac, Josefin Ahlkrona, Alex Jarosch, Doug Brinkerhoff

\maketitle

\sectionsize

\section{Introduction}

Numerical ice sheet (glacier) models with evolving ice geometry are now routinely used for addressing scientific questions such as quantification of future sea level rise from changes in the Antarctic \citep{Seroussietal2020} and Greenlandic \citep{Goelzeretal2020} ice sheets, interpretation of the paleoglacial record \citep{Weberetal2021}, and evaluation of long-term glacial erosion rates \citep{SeguinotDelaney2021}, among other applications.  In order to resolve ice streams as fluid features it is now generally accepted that valid results need horizontal mesh (grid) cells smaller than about 10 km, but narrow outlet glacier flows and alpine topography need yet finer resolution.  Resolving the physics of marine ice sheets also benefits from fine resolution, although careful choice of basal parameterizations will reduce resolution dependence \citep{Gladstoneetal2017}.  Thus, whether using local mesh refinement \citep[for example]{Fischleretal2022,Hoffmanetal2018} or not, resolutions of two or one kilometers \citep{SeguinotDelaney2021} or less \citep{Aschwandenetal2019,Clarkeetal2015} are increasingly used for science at ice sheet scale.

Current-generation ice sheet models apply a variety of stress balances, from the simplest shallow ice approximation (SIA), through ``hybrid'' \citep{Robinsonetal2022,Winkelmannetal2011} and higher-order balances, up to the non-shallow and non-hydrostatic Stokes approximation.  With very few exceptions, however, current time-stepping models alternate between solving the stress balance for velocity, using the geometry determined by the previous time step, and then updating the geometry using the just-computed velocity field.  Therefore ice thickness and surface elevation, equivalent geometry variables for most modeling purposes, are updated after velocity is fixed.  The interaction between the ice sheet and the surrounding climate occurs during this geometry-update operation, via the mass continuity or surface kinematical equations \citep{GreveBlatter2009}.  Such climatic coupling occurs through surface mass balance, sub-shelf (basal) mass balance, and calving processes, in particular.

In other words, these current-generation schemes implement \emph{explicit} time-stepping for the coupled mass and momentum system describing the dynamical evolution of ice sheets.\footnote{Confusingly, various ``semi-implicit'' and even ``fully implicit'' designators appear in the literature for explicit schemes which fix the velocity following the computation which updates the geometry \citep[for example]{Chengetal2017}.}  However, at least for simpler, textbook partial differential equation problems, the limited and conditional stability of such explicit time-stepping schemes is well-understood \citep{LeVeque2007}.  Stability conditions of explicit SIA models appeared some time ago \citep[e.g.][]{HindmarshPayne1996}, but recent studies have focussed on the stability conditions of explicit hybrid, higher-order, and Stokes dynamics models \citep{Chengetal2017,Robinsonetal2022}, or on lengthening their steps \citep{LofgrenAhlkronaHelanow2021}.

However, actual \emph{implicit} time-stepping \citep{LeVeque2007} should also be considered.  Here the velocity and geometry are updated simultaneously by solving coupled mass and momentum conservation equations.  While such implicit time-stepping requires the solution of systems of equations at each step, for glaciers and ice sheets an implicit step must simultaneously compute the velocity field and the \emph{domain on which the velocity is defined}, namely the 3D extent of the ice once the coupled solution has converged.  The problem is of free-boundary type, especially in map-plane (horizontal) directions \citep{SchoofHewitt2013}, but also in the (easily-resolved) vertical direction.

An implicit strategy has been demonstrated at high (900m) resolution for the Greenlandic ice sheet in the simplest frozen-base, isothermal SIA case \citep{Bueler2016}.  That work also shows how the steady-state SIA problem \citep[c.f.][]{JouvetBueler2012} can be solved, demonstrating unconditional stability.  (Observe that steady-state equations correspond to an implicit time step of infinite duration.)

The corresponding problem for the Stokes equations has not, to the author's knowledge, yet been attempted.  However, important early work applying a semi-implicit time step using Stokes dynamics \citep{WirbelJarosch2020} to solve a free boundary problem illuminates some of the techniques and difficulties needed to make such a strategy work for a membrane-stress-resolving balance.

This is the context in which the current note relates time-stepping and stress-balance choices to computational effort.  The simplified performance analysis here exposes the most important considerations and trade-offs.  While this author expects that implicit time-stepping ice sheet models will eventually be the fastest, and that advanced solver techniques like multigrid \citep{Briggsetal2000} will lead to better modeling, such beliefs should be assessed quantitatively to the extent possible.


\section{Coupled geometry-velocity modeling}

Reader familiarity is assumed with the standard SIA and Stokes stress-balance equations \citep{GreveBlatter2009,SchoofHewitt2013}.  These (continuum) models are regarded here as end members of current-usage stress-balance approximations.  Familiarity with the mass continuity and surface kinematical equations \citep{GreveBlatter2009} is also assumed.  However, before analyzing the performance consequences of numerical modeling choices, the form of the mass continuity equation is examined, and then the terms ``explicit'' and ``implicit'' are carefully defined.

For an incompressible ice sheet with thickness $H(t,\bx)$, vertically-averaged horizontal velocity $\bu(t,\bx)$, and climatic-basal mass balance $a(t,\bx)$, the mass continuity equation says
\begin{equation}
\frac{\partial H}{\partial t} + \Divx \left(\bu H\right) = a. \label{eq:masscontinuity}
\end{equation}
(Here $\bx=(x,y)$ denotes the horizontal coordinates.)  Equation \eqref{eq:masscontinuity} suggests that ice sheets change geometry in an essentially advective manner, but this appearance is deceiving, or at least over-simplified, especially regarding the growth of numerical instabilities.  This is because ice flows dominantly downhill.  Indeed, ice sheet flow has no characteristic curves, as would Equation \eqref{eq:masscontinuity} if it were a true advection, because the velocity $\bu$ actually depends on the gradient of thickness through the stress balance.

Thus, as can be addressed by linearized analysis \citep{Robinsonetal2022}, when thickness perturbations grow unstably under explicit time-stepping, i.e.~with too large a step, they do so by a mix of  advective and diffusive mechanisms.  Let $s(t,\bx)=H(t,\bx)+b(\bx)$ denote the surface elevation, for bed elevation $b(\bx)$.  A numerical thickness perturbation will often cause the velocity $\bu$ to respond by increasing in a direction close to downhill ($-\gradx s$), a direction correlated to $-\gradx H$ over large areas of an ice sheet.  In membrane-stress-resolving models like Stokes this happens through the non-local solution of the stress balance, in which the gravitational source term effectively acts along the surface gradient $\gradx s$ because of the ice-domain geometry.  One might write that Equation \eqref{eq:masscontinuity} has velocity $\bu(H,\gradx s)$, a non-local function of geometry, but a stress balance solution is required to evaluate this function.  In any case, a numerical instability of Equation \eqref{eq:masscontinuity} occurs when the ice thickness under/over-shoots its correct value because the numerical velocity from evaluating this non-local function is too strong for the given time step \citep{LeVeque2007}.

\newcommand{\nn}{\text{n}}
A diffusive description of the mass continuity equation is also valid in the small-aspect-ratio limit which generates the SIA \citep{SchoofHewitt2013}:
\begin{equation}
\frac{\partial H}{\partial t} = \Divx \left(d\, \gradx s \right) + a. \label{eq:siamasscontinuity}
\end{equation}
Here $d = C H^{\nn+2} |\gradx s|^{\nn-1}$ is the nonlinear diffusivity.\footnote{In detail, for the isothermal case where $A$ is the ice softness, $\rho$ is the ice density, $g$ is gravity, and $\nn\approx 3$ is the Glen exponent in the flow law \citep{GreveBlatter2009}, one has $C = 2 A (\rho g)^\nn/(\nn+2)$.}  While Equation \eqref{eq:siamasscontinuity} does not hold directly for Stokes or other membrane-stress-resolving dynamics, the same diffusivity $d$, an essentially geometric quantity, can be computed regardless.  Generically across stress balance choices, for grounded glaciers and ice sheets one observes that large values of $d$ indicate locations of unstable mode growth if explicit time-steps are chosen too large.

However, either statement \eqref{eq:masscontinuity} or \eqref{eq:siamasscontinuity} of the mass continuity equation is fundamentally incomplete without modeling the evolving (map-plane) boundary position of the glacier or ice sheet.  The problem of determining this updated margin position is only well-posed via an inequality constraint, namely that ice thickness is nonnegative ($H\ge 0$), equivalently that the ice surface elevation equals or exceeds the bed elevation ($s \ge b$).  The mathematical role of this constraint has been understood for some time in the SIA model \citep{Calvoetal2002,JouvetBueler2012,SchoofHewitt2013}, but its role as the determinant of margin location is universal across fluid-layer problems with signed source terms \citep{Bueler2021conservation}.

In this context one can distinguish time-stepping types in coupled geometry-velocity, i.e.~mass and momentum conserving, glacier and ice sheet models.  A coupled model computes (\emph{fully}) \emph{implicit} time steps if no significant aspects of the geometry or velocity are held fixed during the (coupled) solution.  That is, in an implicit scheme a coupled and well-posed model for the ice surface elevation (or thickness) and velocity field updates is solved.  A scheme which does not allow the map-plane ice-covered region to change during the time step cannot respond physically (i.e.~conservatively with respect to mass and momentum conservation) to a change in climate inputs.  A scheme which is implicit in the sense here can be unconditionally stable; it can stably compute time steps of arbitrary duration causing nontrivial changes in margin position.  Next, a coupled scheme is \emph{semi-implicit} if, in particular, aspects of the ice geometry are held fixed during the geometry-velocity solution, or, for instance, if the velocity is held fixed during a time step as the geometry is updated (though perhaps ``implicitly'' on its own).  Thus a scheme which computes margin advance or retreat only after the velocity field update is accepted is only semi-implicit, for example.  Finally, a scheme is (\emph{fully}) \emph{explicit} for the coupled problem if the ice geometry is held fixed during the velocity solution, and then this (accepted and now fixed) velocity solution is used to update the geometry through an explicit step for Equation \eqref{eq:masscontinuity}.

Thus a key point about time-stepping schemes for the coupled geometry and velocity problem for glaciers and ice sheets is that implicit schemes are not solving fixed-domain systems of coupled PDEs.  The mathematical problem for the coupled and implicit time-step includes the condition which controls the moving and free boundary, namely the inequality constraint of nonnegative thickness.  Implicit schemes which solve these free-boundary problems at each time step can, at high spatial resolution, transcend stability limitations on time step duration.  They, and only they, can do time-stepping at a rate controlled only by ice-climate interaction time scales.


\section{Performance analysis}

Table \ref{tab:notation} lists the parameters used in the numerical model performance analysis which follows.  The primary parameters are $\Delta x$, which is a representative value for the horizontal mesh (grid) cell diameter, and $m$, the number of nodes (vertices) in the horizontal mesh.  \emph{High resolution} refers to the equivalent $\Delta x\to 0$ and $m\to\infty$ limits; asymptotic and big-O notation is used only in this limit.

\begin{table*}[ht]
{\normalsize
\begin{tabular}{cll}
\emph{name} & \emph{meaning} & \emph{units} \\ \hline
$\alpha$    & one fixed-geometry Stokes velocity solution is $O(n^{1+\alpha})${\large \strut} work\\
$\beta$     & one implicit SIA geometry (and velocity) solution is $O(n^{1+\beta})$ work \\
$\gamma$    & one implicit, coupled Stokes geometry and velocity solution is $O(n^{1+\gamma})$ work \\
$D$         & representative geometric (SIA) diffusivity of an ice sheet & $\text{km}^2 \text{a}^{-1}$ \\
$L$         & width of map-plane domain & km \\
$m$         & degrees of freedom: number of nodes in the horizontal mesh \\
$q$         & time steps per model year needed to resolve ice-climate interactions & $\text{a}^{-1}$ \\
$\Delta t$  & length of time step & a \\
$U$         & representative horizontal ice velocity & $\text{km}\,\text{a}^{-1}$ \\
$\Delta x$  & representative width (diameter) of map-plane mesh cells & km
\end{tabular}
}
\caption{Parameters for performance analysis.  Note $\alpha$, $\beta$, $\gamma$, and $m$ are pure, unit-less numbers.}
\label{tab:notation}
\end{table*}

Assuming the map-plane extent of the model domain is 2D\footnote{In flow-line models $\Delta x \sim L m^{-1}$, but this paper addresses 3D models with map-plane (2D) horizontal meshes.} and of width $L$, these primary parameters are related by
\begin{equation}
\Delta x \sim \frac{L}{m^{1/2}} \quad \text{and} \quad m \sim \frac{L^2}{\Delta x^2}.  \label{eq:paramrelation}
\end{equation}
Specifically, for fixed domain width $L$ there are $O(m^{1/2})$ mesh cells in each horizontal dimension.

A numerical glacier or ice sheet model uses $m$ ice thickness or surface elevation variables, i.e.~one \emph{degree of freedom} per mesh node, including at ice-free nodes where the thickness has value zero.  Storing these model state variables, plus the thermodynamical state, requires $O(m)$ memory if the mesh/grid has \emph{a priori} bounded resolution in the vertical direction.  The amount of computer memory needed by the simulation is also $O(m)$, assuming prior states are discarded.

Such models also have $O(m)$ velocity variables, but note that these are not state variables, essentially because the Stokes model lacks time derivatives.  That is, a very-viscous stress balance computes velocity as a function of the true state variables, such as ice thickness and temperature or enthalpy.

The above assumption of fixed vertical resolution reflects common usage \citep[for example]{Aschwandenetal2019,BrinkerhoffJohnson2015,Hoffmanetal2018,Lengetal2012,
Winkelmannetal2011}, and it permits a rational comparison of asymptotics, but it is not the only possibility.  Some solvers use 3D refinement \citep{BrownSmithAhmadia2013,IsaacStadlerGhattas2015,Tuminaroetal2016}, with various distinctions between how horizontal and vertical meshing is handled, but this and many other details cannot be pursued here.

Glacier and ice sheet models resolve and integrate ice-climate interactions, especially via surface mass balance, on time scales which are dominated by an annual cycle, and on longer scales.  Let $q$ be the number of ice-dynamical time steps per year needed to capture this coupling.  Typical values $q=0.1 \,\text{a}^{-1}, 1 \,\text{a}^{-1}, 12 \,\text{a}^{-1}$ correspond to decadal, yearly, and monthly frequency, respectively.  Note that energy balance and degree-day schemes for computing surface mass balance \citep{Hock2005} generally have much shorter time scales, but here $q$ describes the \emph{coupling} frequency on which ice geometry needs to be updated via solution of the mass continuity or surface kinematical equation.

Current-technology glacier and ice sheet models use explicit time-stepping which is only conditionally stable.  For the spatial resolutions used in present-day scientific applications, maintenance of explicit time-stepping stability requires steps substantially shorter than $1/q$ model years.  That is, the performance of current-generation models is limited by numerical analysis choices, and not by scientific needs.

For an explicit SIA model the well-known stability restriction is $\Delta t < O(D^{-1} \Delta x^2)$ \citep{Bueleretal2005,HindmarshPayne1996}, where $D$ is a representative diffusivity value, i.e.~of $d$ in equation \eqref{eq:siamasscontinuity}.  For Stokes models, or other membrane-stress-resolving dynamics, the stability of explicit time-stepping is largely unexplored in any precise sense, but an advective restriction $\Delta t < O(U^{-1} \Delta x)$, for some representative horizontal velocity scale $U$, might be said to represent the \emph{optimistic} paradigm.  The corresponding \emph{pessimistic} paradigm for Stokes models says $\Delta t < O(D^{-1} \Delta x^2)$, using a representative diffusivity value $D$ computed in the SIA manner.

Explicit time-stepping with hybrid and higher-order schemes is somewhat better-studied than for Stokes dynamics, especially over horizontal resolutions relevant to whole ice sheets.  Some hybrid schemes apply the pessimistic paradigm as an adaptive restriction \citep{Winkelmannetal2011} across all spatial scales.  Other models apparently require the user to choose a fixed time step through trial and error in some circumstances \citep[for example]{Fischleretal2022,Robinsonetal2022}.  The optimistic paradigm has theoretical support for a certain higher-order DIVA scheme \citep[Equation (52)]{Robinsonetal2022}, but practical Greenland simulations in the same work actually suggest an intermediate power $\Delta t \approx O(\Delta x^{1.6})$ \citep[Figure 3(a)]{Robinsonetal2022}.  An intermediate power, a restriction $\Delta t = O(\Delta x^\omega)$ for some fuzzy value $1.5<\omega<2$, also aligns with this author's experience.

Unconditionally-stable implicit schemes also have a maximum time step restriction, namely $\Delta t < O(q^{-1})$, but this restriction reflects the simulation purpose, not maintenance of stability.  For an implicit scheme the desired frequency of ice-climate interaction will, however, determine the total simulation cost according to the (large) solution cost, at each time step, of solving a coupled mass and momentum free-boundary problem, including the surface kinematical or mass continuity equation.

% see data/scaling.m for results in next paragraphs

For each explicit time step of a model which applies a membrane-stress-resolving balance, the computational cost of a velocity (or velocity/pressure) solution of the stress balance equations is determined by solver design.  Let us assume that one such solution requires $O(m^{1+\alpha})$ floating point operations (flops),  with the power $\alpha\ge 0$ depending on the solver implementation.  For example, a Stokes solver using direct linear algebra for each Newton step might yield $\alpha \approx 1$ if sparsity is exploited or $\alpha \approx 2$ if not \citep{Bueler2021}.  However, a multigrid method \citep{Trottenbergetal2001} can greatly reduce $\alpha$, and the ideal value $\alpha=0$ describes an \emph{optimal} solver in the language of algorithmic scaling or solver complexity \citep{Bueler2021}.  For example, Antarctic ice sheet results by \cite{IsaacStadlerGhattas2015}, for a Stokes solver implemented using algebraic multigrid, show that the total number of preconditioned Krylov iterations, over the nonlinear solve, grows slowly under mesh refinement, suggesting perhaps $\alpha\approx 0.2$ \citep[Table 8.1]{IsaacStadlerGhattas2015}.  The \cite{Lengetal2012} algebraic-multigrid Stokes solver may have similar scaling, but reported results do not constrain $\alpha$.  For a higher-order stress balance on the Greenlandic ice sheet, \cite{Tuminaroetal2016} report total algebraic-multigrid-preconditioned iterations suggesting $\alpha \approx 0.05$,\footnote{See \citep[Table 7.5]{Tuminaroetal2016}.  Somewhat worse performance for the Antarctic ice sheet is diagnosed as caused by the difficulties in discretizing a marine margin.} and a geometric multigrid method by \citep{BrownSmithAhmadia2013} suggests $\alpha$ is close to zero for simplified geometries.  Observe that the SIA velocity computation, a trivialization of the Stokes problem in which velocity is computed by a pointwise formula, requires optimal $O(m)$ flops.

When analyzing solver scaling in our simplified form, one must be aware that the constant in ``$O(m^{1+\alpha})$'' above can be very large, and it depends strongly on solver design.  Furthermore, many considerations are suppressed in any flops-based analysis of algorithmic scaling, as actual run time is also determined by memory latency, memory bandwidth, and process/thread/GPU parallelism, among other factors.  Indeed, many models \citep[e.g.][]{BrownSmithAhmadia2013, Fischleretal2022, IsaacStadlerGhattas2015, Lengetal2012, Tuminaroetal2016} also show good \emph{parallel} scaling, something not addressed here.

Regardless of the stress balance, an explicit time-stepping scheme will first compute velocity from current geometry and then apply the mass continuity equation to update the ice thickness using $O(m)$ work.  That is, once the velocity is computed from the last-known geometry, let us assume that an explicit scheme replaces old thickness values by new ones using an optimal pointwise formula.\footnote{Any additional computation needed to remesh the updated geometry, a highly design-dependent cost, is omitted here.}

\newcommand{\oo}[1]{\displaystyle O\left(#1\right)}
\setlength{\tabcolsep}{5pt}
\renewcommand{\arraystretch}{1.5}
\begin{table*}[ht]
{\normalsize
\begin{tabular}{llll}
\emph{time-stepping} & \emph{dynamics} & \emph{flops per model year} & \emph{[pessimistic stability]} \\ \hline
explicit & SIA    & $\oo{\frac{D\, L^2}{\Delta x^4}} = \oo{\frac{D\, m^2}{L^2}}${\Huge \strut} \\
explicit & Stokes & $\oo{\frac{U L^{2+2\alpha}}{\Delta x^{3+2\alpha}}} = \oo{\frac{U m^{1.5+\alpha}}{L}}${\Huge \strut}\phantom{x} & $\oo{\frac{D\, L^{2+2\alpha}}{\Delta x^{4+2\alpha}}} = \oo{\frac{D\,m^{2+\alpha}}{L^2}}$ \\
implicit & SIA    & $\oo{\frac{q\, L^{2+2\beta}}{\Delta x^{2+2\beta}}} = \oo{q\, m^{1+\beta}}${\Huge \strut} \\
implicit & Stokes & $\oo{\frac{q\, L^{2+2\gamma}}{\Delta x^{2+2\gamma}}} = \oo{q\, m^{1+\gamma}}${\Huge \strut}
\end{tabular}
}
\caption{Asymptotic estimates of algorithmic scaling, measured by floating point operations per model year, for map-plane (2D) time-stepping numerical ice sheet simulations, in the high resolution limit where $\Delta x\to 0$ and $m\to\infty$.  See Table \ref{tab:notation} for notation.}
\label{tab:performancemodel}
\end{table*}

Now, how many flops are needed to simulate one model year?  Suppose a numerical model takes time steps of $\Delta t$ model years duration, equivalently $\Delta t^{-1}$ steps per model year.  In these terms stability restrictions give required numbers of steps per model year.  That is, stability requires that $\Delta t^{-1}$ be bounded below by a function of the horizontal resolution $\Delta x$ or the degrees of freedom $m$.  Recalling the scaling in Equation \eqref{eq:paramrelation}, the explicit SIA and pessimistic-Stokes cases have
\begin{equation}
\frac{1}{\Delta t} > \oo{\frac{D}{\Delta x^2}} = \oo{\frac{D m}{L^2}}. \label{eq:explicitsiarequired}
\end{equation}
The explicit, optimistic-Stokes estimate becomes
\begin{equation}
\frac{1}{\Delta t} > \oo{\frac{U}{\Delta x}} = \oo{\frac{U m^{1/2}}{L}}. \label{eq:explicitoptstokesrequired}
\end{equation}
The number of time steps per model year is then multiplied by the per-step computational cost, namely $O(m^{1+\alpha})$ for Stokes models and $O(m)$ for SIA models, to give a work estimate for each model year in a simulation.  The results so far are shown in the ``explicit'' rows of Table \ref{tab:performancemodel}.

As already explained, unconditionally-stable implicit methods may have a fixed time step $\Delta t = 1/q$, independent of $\Delta x$ and determined only by the need to resolve ice-climate interactions.  On the other hand, the per-step expense is much greater because nontrivial coupled equations, and a free-boundary problem, must be solved simultaneously for the updated velocity and geometry.

% regarding next paragraph, see data/bueler.perf and data/scaling.m
For SIA models, let us assume that the flops of such coupled solutions scale as $O(m^{1+\beta})$ with $\beta \ge 0$; a large constant is assumed.  The only currently implemented, unconditionally-stable, fully-implicit time-step solvers use the SIA stress balance.  For simplified (dome) geometry the scheme in \cite{Bueler2016}, based on Newton steps solved via direct linear algebra and single-grid ice margin determination, directly computes steady states with scaling $\beta=0.8$.  (An earlier steady, Picard iteration implementation by \cite{JouvetBueler2012} scales worse.)  Convergence is also robust for implicit time steps of years to centuries on kilometer-scale grids for the Greenland ice sheet, using realistic and irregular bed topographies.

Certain recent numerical models are semi-implicit in innovative ways.  The SIA portions of hybrid time-stepping schemes by \cite{JouvetGraeser2013} and \cite{BrinkerhoffJohnson2015} are solved implicitly, with nonnegativity of thickness in their SIA portions enforced as part of a free-boundary solution.  However, the time-stepping in these models is only semi-implicit because the membrane-stress-resolving portion of the velocity is held fixed as the ice thickness is advected.  The SIA time-step solvers in these schemes have apparently only been tested for time steps satisfying an advective condition $\Delta t < O(U^{-1}\Delta x)$, for $U$ derived from sliding speeds.  (Also, \cite{JouvetGraeser2013} use multigrid methods, but their published results do not constrain the power $\beta$.)
% equation (20) in JouvetGraeser2013
% equation (A21) in BrinkerhoffJohnson2015
The semi-implicit scheme in the open-source \'Ua numerical marine ice sheet model \citep{Gudmundsson2013,Gudmundsson2021manual} implicitly solves mass continuity free-boundary problem for Equation \eqref{eq:masscontinuity} using an active set method, but also while holding the (membrane-stress-resolved) velocity fixed.
% equations (1), (26) in Gudmundson2013
% see semi-implicit comments in commit 9081fdbe3cf250d9cfd66504bf03134043ba2547
% https://github.com/GHilmarG/UaSource/blob/master/NexthTG3in2D.m: "Third order impicit Taylor-Galerkin (implict with respect to h, not u and v)"
% https://github.com/GHilmarG/UaSource/blob/master/SSS2dPrognostic.m: "semi-implicit forward integration. implicit with respect to thickness (h) explicit with respect to velocity"
% and "error('Semi-implicit time integration only implemented for SSTREAM and not SSHEET or Hybrid formulations \n')"

For implicit Stokes time-stepping, a coupled and free-boundary velocity and geometry-update solve is assumed to be, in the absence of constraining research, $O(m^{1+\gamma})$ for some $\gamma \ge \alpha$ to be determined.  One might also suppose $\gamma\ge \beta$, but there are no implemented cases to measure.  These comments complete Table \ref{tab:performancemodel}.  Note that all implicit scheme estimates involve an especially-large scheme-dependent constant.


\section{Discussion and Conclusion}

From Table \ref{tab:performancemodel} one first observes a well-known property of explicit time-stepping for 2D (map-plane) diffusion equations such as SIA equation \eqref{eq:siamasscontinuity}, namely that computational effort, here flops per model year, scales as $O(\Delta x^{-4})$.  This follows because $\Delta t < O(\Delta x^2)$, and because the expense of one geometry-update operation is $O(m) = O(\Delta x^{-2})$.  Spatial mesh refinement by a factor of two therefore imposes an impressive 16-times increase in effort.

The scaling of the \cite{Bueler2016} implicit SIA solver is not enough better than such an explicit scheme, however.  Although long time steps can be taken by this implicit solver, the $\beta=0.8$ scaling gives $O(\Delta x^{-3.6})$ effort.  However, an improvement to $\beta < 0.5$, presumably by application of a multigrid method, would transform such an implicit solver into a tool with notably-superior $O(\Delta x^{-3})$ performance or better.

Now bypassing the over-simplified SIA stress balance, we see from Table \ref{tab:performancemodel} how the algorithmic scaling of membrane-stress-resolving solvers dominates performance concerns.  In particular, an $\alpha \approx 1$ explicit Stokes model, e.g.~one using direct, sparsity-exploiting linear algebra on each Newton step system, will do work which scales at the horrific rate $O(\Delta x^{-6})$ under a pessimistic stability condition.  Optimistic stability yields a still-bad $O(\Delta x^{-5})$ rate.  These simple observations emphasize the key role which will be played by multigrid-based stress balance solvers.  That is, even retaining explicit time-stepping, nearly-optimal ($\alpha \approx 0$) scaling of computation effort in Stokes and higher-order solvers will be necessary for routine application on high-resolution meshes.

On the other hand, suppose resolution ($\Delta x$) is fixed.  The Table also shows why algorithmic scaling remains important in the large-domain $L\to\infty$ limit when applying Stokes or higher-order dynamics.  The computational work of a nearly-optimal $\alpha \approx 0$ solver will be proportional to ice sheet area $L^2$.  However, an $\alpha \approx 1$ method which might suffice for a smaller $L=100$ km ice cap will struggle for a $L=1000$ km ice sheet because the effort scales as the fourth ($2+2\alpha \approx 4$) power of $L$.

The promise of nearly-optimal solvers is truly revealed, however, when implicit, coupled geometry-velocity updates are considered.  If they become possible, methods which simultanously satisfy the mass and momentum equations at each time step, doing work (essentially) proportional to the number of degrees of freedom, have great promise.  A $\gamma \approx 0$ implicit Stokes method would be capable of many new tasks.  More achievably, a $\gamma < 0.5$ implicit, essentially unconditionally-stable, Stokes time-stepping method, presumably based on multigrid solution of the free-boundary problem for the coupled mass and momentum equations, is an appropriate goal for coming decades of research on numerical ice sheet models.  The computation cost would scale at $O(\Delta x^{-3})$, better than explicit SIA models, and the method would only update ice geometry when needed by ice-climate coupling, while avoiding shallow approximations.  (The same goal makes sense for any membrane-stress-resolving solver.)  Little technical progress has yet been made on such a coupled, fully-implicit, and scalable Stokes design \cite[but see][]{WirbelJarosch2020}, so these aspirations are decidedly long-term.  However, the above discussion suggests why measured values for $\alpha,\beta,\gamma$, or equivalent algorithmic scaling measures, are important performance metrics to report when describing new ice sheet solvers.

\subsection{Acknowledgements}  Comments by Jed Brown, editor Ralf Greve, referee Alex Jarosch, and especially an anonymous referee have helped to focus and improve this work.  However, opinions expressed here, and any remaining errors, are entirely those of the author.

%         References
\bibliography{perfmod}
\bibliographystyle{igs}

\end{document}
